# SIEM - Splunk

Splunk is a powerful platform that enables organizations to monitor, analyze, and act on data to detect security threats, prevent incidents, and optimize business operations. It helps security analysts by providing real-time visibility and comprehensive insights into machine data, allowing for rapid identification of potential risks and system anomalies.

## Overview

Security Information and Event Management (SIEM) systems like Splunk are integral to an organization’s security operations. Splunk is especially effective in indexing, searching, and visualizing data generated across various systems, which helps security teams identify security events, troubleshoot problems, and ensure compliance.

The core of working with Splunk is its Search Processing Language (SPL), a powerful query language that helps users effectively navigate large datasets, perform detailed searches, and identify trends or anomalies within data. By leveraging SPL’s rich features, including pipes, wildcards, and time modifiers, analysts can filter and analyze events based on specific criteria.

## Scenario

You are a security analyst at TechSynergy Corp, a leading global software company. Your current task is to investigate any potential security concerns involving the company's web servers. Specifically, you need to determine whether there have been any failed SSH login attempts targeting the "admin" account on the primary web server.

You’ve received log data from the following systems, which you'll need to upload into Splunk:

- `web01` - The primary web server for TechSynergy Corp.
- `app02` - An internal application server.
- `db03` - A database server that stores customer data.
- `sales_data` - A data warehouse with sales and marketing information.

## Expectation

- Upload and index log data into Splunk.
- Execute searches to analyze specific security events.
- Examine various data sources and correlate events to identify security threats.
- Detect failed SSH login attempts targeting the admin account.

## Step-by-step

Follow these steps to perform the analysis using Splunk:

1. **Login to Splunk**: Start by logging into your Splunk instance or signing up if you don’t have an account.

2. **Upload Data**: 
    - Navigate to the Splunk Dashboard and click on the "Add Data" option from the menu.
    - Upload the `logs.zip` file, which contains the log data from the systems mentioned.

3. **Select Data Source**:
    - After uploading, navigate to the "Search and Reporting" tab.
    - Use the following search query to access the indexed data: `index=main`. Select "All time" to view events across all periods.

4. **Use Time Filters**:
    - Use the time range dropdown or SPL time modifiers to adjust the range of the search. Narrowing the time range will speed up the search process.

5. **Understand Key Data Components**:
    - **Host**: Specifies the system that generated the log event.
    - **Source**: Indicates the origin or location of the log data within the system.
    - **Sourcetype**: Describes the format or structure of the data for accurate parsing by Splunk.

6. **Search for Failed SSH Logins**:
    - To investigate login attempts on the web server, search using the following query: `index=main host=web01`.
    - You’ll see a list of over 12,000 events generated by the web server.

7. **Search for Failed Root Logins**:
    - Now, refine your search to look for failed SSH login attempts targeting the admin account with the following query: 
      `index=main host=web01 fail* admin`
    - This search will include variations of failed login attempts like `failed` or `failure`.

8. **Investigate the Results**:
    - You may notice that the search yields a large number of results, which may require additional filtering or time-based adjustments to narrow down.
    - In this case, there are 152 failed SSH login attempts for the admin account between February 1st, 2024, and February 11th, 2024, across several different IP addresses.

9. **Further Analysis**:
    - To better understand the nature of these login attempts, review the raw log data and correlate the failed login attempts with other events.
    - Examine events with the `host`, `source`, and `sourcetype` fields to uncover patterns, and consider investigating IP addresses that appear to be repeatedly trying to access the system.
